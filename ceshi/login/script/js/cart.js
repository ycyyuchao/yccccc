!function(){if(getCookie("UserName")?($(".top .verclome").hide(),$(".top .back").show()):($(".top .verclome").show(),$(".top .back").hide()),$(".top .back a").on("click",function(){var t=getCookie("UserName");delCookie("UserName",t),$(".top .verclome").show(),$(".top .back").hide()}),getCookie("cartsid")&&getCookie("cartnum")){var t=getCookie("cartsid").split(","),n=getCookie("cartnum").split(",");$.each(t,function(t,i){var o,r;o=i,r=n[t],$.ajax({url:"http://10.31.156.76/server/Second/panli/php/indeximgdata.php",dataType:"json"}).done(function(a){$.each(a.detailsdata,function(t,i){if(o==i.sid){var n=$("tr:hidden").clone(!0);n.find(".secondtd").find("img").attr("src",a.detailsdata[t].url.split(",")[0]),n.find(".secondtd").find("img").attr("sid",a.detailsdata[t].sid),n.find(".secondtd").find("p").find("a").html(a.detailsdata[t].title),n.find(".thirdtd b").html(a.detailsdata[t].price),n.find(".jiajian").find("input").val(r);var e=i.price*r;n.find(".fortd").html(e.toFixed(2)),n.css("display","block"),$("table").append(n),s(),d()}})})})}var e=[],a=[];function o(){getCookie("cartsid")&&(e=getCookie("cartsid").split(",")),getCookie("cartnum")&&(a=getCookie("cartnum").split(","))}function s(){getCookie("cartsid")?$(".empty-cart").hide():$(".empty-cart").show()}function d(){var t=0;$("tr:visible").each(function(){$(this).find("input:checkbox").is(":checked")&&(t+=parseFloat($(this).find(".fortd").html()),parseInt($(this).find(".secondtr.thirdtd").find("input").val()))}),$("#totalProPrice").html("￥"+t.toFixed(2)),$("#totalProPrice1").html("￥"+t.toFixed(2)),$("#totalProPrice2").html("￥"+t.toFixed(2))}function i(t){return(parseFloat(t.parents(".firsttr").find(".thirdtd b").html())*parseInt(t.parents(".firsttr").find(".jiajian input").val())).toFixed(2)}s(),$(".jiajian .jia").on("click",function(){var t=$(this).parents(".firsttr").find(".jiajian input").val();99<=++t&&(t=99),$(this).parents(".firsttr").find(".jiajian input").val(t),$(this).parents(".firsttr").find(".fortd").html(i($(this))),d(),function(t){o();var i=t.parents(".firsttr").find(".secondtd img").attr("sid");a[e.indexOf(i)]=t.parents(".firsttr").find(".jiajian input").val(),addCookie("cartnum",a.toString(),7),console.log(e),console.log(i),console.log(e.indexOf(i)),console.log(t.parents(".firsttr").find(".jiajian input").val()),console.log(a)}($(this))}),$(".jiajian .jian").on("click",function(){var t=$(this).parents(".firsttr").find(".jiajian input").val();--t<=1&&(t=1),$(this).parents(".firsttr").find(".jiajian input").val(t),$(this).parents(".firsttr").find(".fortd").html(i($(this))),console.log(i($(this))),d()}),$(".jiajian input").on("input",function(){var t=parseInt($(this).val());/^\d+$/g.test(t)?99<=t?$(this).val(99):t<=0?$(this).val(1):$(this).val(t):$(this).val(1),$(this).parents(".firsttr").find(".fortd").html(i($(this))),console.log(i($(this))),d()}),$(".allsel").on("change",function(){$("tr:visible").find("input:checkbox").prop("checked",$(this).prop("checked")),$(".allsel").prop("checked",$(this).prop("checked")),d()});var r=$("tr:visible").find("input:checkbox");function c(t,i){var n=$.inArray(t,i);console.log(n),i.splice(n,1),a.splice(n,1),addCookie("cartsid",i.toString(),7),addCookie("cartnum",a.toString(),7)}$("table").on("change",r,function(){var t=$("tr:visible").find("input:checkbox");$("tr:visible").find("input:checked").length==t.size()?$(".allsel").prop("checked",!0):$(".allsel").prop("checked",!1),d()}),$("table").on("click",".sixtd a",function(t){o(),confirm("你确定要删除吗？")&&$(this).first().parents("tr").remove(),c($(this).first().parents("tr").find("img").attr("sid"),e),d()}),$(".all .del a").on("click",function(){$("tr:visible").each(function(){$(this).find("input:checkbox").is(":checked")&&($(this).remove(),c($(this).find("img").attr("sid"),e))}),d()})}(jQuery);